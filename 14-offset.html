<!DOCTYPE html><html lang="en"><head><title>14-offset</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="14-offset"><meta name="groc-project-path" content="jquery-1.6.2/14-offset.js"><meta name="groc-github-url" content="https://github.com/nevir/jquery-annotated-source"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/nevir/jquery-annotated-source/blob/master/jquery-1.6.2/14-offset.js">jquery-1.6.2/14-offset.js</a></div></div><div id="document"><div class="segment"><div class="comments"><div class="wrapper"><p><strong>jQuery Annotated Source</strong>.</p></div></div><div class="code"><div class="wrapper"><span class="c1">//</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p><a href="/jquery-annotated-source/">Home</a> | <a href="13-effects.html">Previous Chapter</a> | <a href="15-dimensions.html">Next Chapter</a></p></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h2 id="offset">Offset</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="kd">var</span> <span class="nx">rtable</span> <span class="o">=</span> <span class="sr">/^t(?:able|d|h)$/i</span><span class="p">,</span>
  <span class="nx">rroot</span> <span class="o">=</span> <span class="sr">/^(?:body|html)$/i</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="s2">&quot;getBoundingClientRect&quot;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">offset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">box</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">i</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">setOffset</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">i</span> <span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">elem</span> <span class="o">||</span> <span class="o">!</span><span class="nx">elem</span><span class="p">.</span><span class="nx">ownerDocument</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">elem</span> <span class="o">===</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">body</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">bodyOffset</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="nx">box</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">,</span>
      <span class="nx">docElem</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Make sure we're not dealing with a disconnected DOM node</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">box</span> <span class="o">||</span> <span class="o">!</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span> <span class="nx">docElem</span><span class="p">,</span> <span class="nx">elem</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">box</span> <span class="o">?</span> <span class="p">{</span> <span class="nx">top</span><span class="o">:</span> <span class="nx">box</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="nx">box</span><span class="p">.</span><span class="nx">left</span> <span class="p">}</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">top</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span>
      <span class="nx">win</span> <span class="o">=</span> <span class="nx">getWindow</span><span class="p">(</span><span class="nx">doc</span><span class="p">),</span>
      <span class="nx">clientTop</span>  <span class="o">=</span> <span class="nx">docElem</span><span class="p">.</span><span class="nx">clientTop</span>  <span class="o">||</span> <span class="nx">body</span><span class="p">.</span><span class="nx">clientTop</span>  <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">clientLeft</span> <span class="o">=</span> <span class="nx">docElem</span><span class="p">.</span><span class="nx">clientLeft</span> <span class="o">||</span> <span class="nx">body</span><span class="p">.</span><span class="nx">clientLeft</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">scrollTop</span>  <span class="o">=</span> <span class="nx">win</span><span class="p">.</span><span class="nx">pageYOffset</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">boxModel</span> <span class="o">&amp;&amp;</span> <span class="nx">docElem</span><span class="p">.</span><span class="nx">scrollTop</span>  <span class="o">||</span> <span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">,</span>
      <span class="nx">scrollLeft</span> <span class="o">=</span> <span class="nx">win</span><span class="p">.</span><span class="nx">pageXOffset</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">boxModel</span> <span class="o">&amp;&amp;</span> <span class="nx">docElem</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span> <span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span>
      <span class="nx">top</span>  <span class="o">=</span> <span class="nx">box</span><span class="p">.</span><span class="nx">top</span>  <span class="o">+</span> <span class="nx">scrollTop</span>  <span class="o">-</span> <span class="nx">clientTop</span><span class="p">,</span>
      <span class="nx">left</span> <span class="o">=</span> <span class="nx">box</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">scrollLeft</span> <span class="o">-</span> <span class="nx">clientLeft</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">{</span> <span class="nx">top</span><span class="o">:</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="nx">left</span> <span class="p">};</span>
  <span class="p">};</span>

<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">offset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">i</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">setOffset</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">i</span> <span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">elem</span> <span class="o">||</span> <span class="o">!</span><span class="nx">elem</span><span class="p">.</span><span class="nx">ownerDocument</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">elem</span> <span class="o">===</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">body</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">bodyOffset</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">computedStyle</span><span class="p">,</span>
      <span class="nx">offsetParent</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">,</span>
      <span class="nx">prevOffsetParent</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">,</span>
      <span class="nx">doc</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">,</span>
      <span class="nx">docElem</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span>
      <span class="nx">body</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span>
      <span class="nx">defaultView</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">defaultView</span><span class="p">,</span>
      <span class="nx">prevComputedStyle</span> <span class="o">=</span> <span class="nx">defaultView</span> <span class="o">?</span> <span class="nx">defaultView</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="kc">null</span> <span class="p">)</span> <span class="o">:</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">,</span>
      <span class="nx">top</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">,</span>
      <span class="nx">left</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nx">elem</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">elem</span> <span class="o">!==</span> <span class="nx">body</span> <span class="o">&amp;&amp;</span> <span class="nx">elem</span> <span class="o">!==</span> <span class="nx">docElem</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">supportsFixedPosition</span> <span class="o">&amp;&amp;</span> <span class="nx">prevComputedStyle</span><span class="p">.</span><span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;fixed&quot;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">computedStyle</span> <span class="o">=</span> <span class="nx">defaultView</span> <span class="o">?</span> <span class="nx">defaultView</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span> <span class="o">:</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">;</span>
      <span class="nx">top</span>  <span class="o">-=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
      <span class="nx">left</span> <span class="o">-=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nx">elem</span> <span class="o">===</span> <span class="nx">offsetParent</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">top</span>  <span class="o">+=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">;</span>
        <span class="nx">left</span> <span class="o">+=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">doesNotAddBorder</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">doesAddBorderForTableAndCells</span> <span class="o">&amp;&amp;</span> <span class="nx">rtable</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">top</span>  <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">computedStyle</span><span class="p">.</span><span class="nx">borderTopWidth</span>  <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
          <span class="nx">left</span> <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">computedStyle</span><span class="p">.</span><span class="nx">borderLeftWidth</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">prevOffsetParent</span> <span class="o">=</span> <span class="nx">offsetParent</span><span class="p">;</span>
        <span class="nx">offsetParent</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">subtractsBorderForOverflowNotVisible</span> <span class="o">&amp;&amp;</span> <span class="nx">computedStyle</span><span class="p">.</span><span class="nx">overflow</span> <span class="o">!==</span> <span class="s2">&quot;visible&quot;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">top</span>  <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">computedStyle</span><span class="p">.</span><span class="nx">borderTopWidth</span>  <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">left</span> <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">computedStyle</span><span class="p">.</span><span class="nx">borderLeftWidth</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">prevComputedStyle</span> <span class="o">=</span> <span class="nx">computedStyle</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">prevComputedStyle</span><span class="p">.</span><span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;relative&quot;</span> <span class="o">||</span> <span class="nx">prevComputedStyle</span><span class="p">.</span><span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;static&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">top</span>  <span class="o">+=</span> <span class="nx">body</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">;</span>
      <span class="nx">left</span> <span class="o">+=</span> <span class="nx">body</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">supportsFixedPosition</span> <span class="o">&amp;&amp;</span> <span class="nx">prevComputedStyle</span><span class="p">.</span><span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;fixed&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">top</span>  <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span> <span class="nx">docElem</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">,</span> <span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="p">);</span>
      <span class="nx">left</span> <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span> <span class="nx">docElem</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span> <span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span> <span class="nx">top</span><span class="o">:</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="nx">left</span> <span class="p">};</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="nx">container</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span> <span class="nx">innerDiv</span><span class="p">,</span> <span class="nx">checkDiv</span><span class="p">,</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">td</span><span class="p">,</span> <span class="nx">bodyMarginTop</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="s2">&quot;marginTop&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">html</span> <span class="o">=</span> <span class="s2">&quot;&lt;div style=&#39;position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;&#39;&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;table style=&#39;position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;&#39; cellpadding=&#39;0&#39; cellspacing=&#39;0&#39;&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>

    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">container</span><span class="p">.</span><span class="nx">style</span><span class="p">,</span> <span class="p">{</span> <span class="nx">position</span><span class="o">:</span> <span class="s2">&quot;absolute&quot;</span><span class="p">,</span> <span class="nx">top</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">margin</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">border</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;1px&quot;</span><span class="p">,</span> <span class="nx">height</span><span class="o">:</span> <span class="s2">&quot;1px&quot;</span><span class="p">,</span> <span class="nx">visibility</span><span class="o">:</span> <span class="s2">&quot;hidden&quot;</span> <span class="p">}</span> <span class="p">);</span>

    <span class="nx">container</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">html</span><span class="p">;</span>
    <span class="nx">body</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span> <span class="nx">container</span><span class="p">,</span> <span class="nx">body</span><span class="p">.</span><span class="nx">firstChild</span> <span class="p">);</span>
    <span class="nx">innerDiv</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span>
    <span class="nx">checkDiv</span> <span class="o">=</span> <span class="nx">innerDiv</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span>
    <span class="nx">td</span> <span class="o">=</span> <span class="nx">innerDiv</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">doesNotAddBorder</span> <span class="o">=</span> <span class="p">(</span><span class="nx">checkDiv</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">!==</span> <span class="mi">5</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">doesAddBorderForTableAndCells</span> <span class="o">=</span> <span class="p">(</span><span class="nx">td</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">===</span> <span class="mi">5</span><span class="p">);</span>

    <span class="nx">checkDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s2">&quot;fixed&quot;</span><span class="p">;</span>
    <span class="nx">checkDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="s2">&quot;20px&quot;</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>safari subtracts parent border width here which is 5px</p></div></div><div class="code"><div class="wrapper">    <span class="k">this</span><span class="p">.</span><span class="nx">supportsFixedPosition</span> <span class="o">=</span> <span class="p">(</span><span class="nx">checkDiv</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">===</span> <span class="mi">20</span> <span class="o">||</span> <span class="nx">checkDiv</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">===</span> <span class="mi">15</span><span class="p">);</span>
    <span class="nx">checkDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">checkDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

    <span class="nx">innerDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflow</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span><span class="p">;</span>
    <span class="nx">innerDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s2">&quot;relative&quot;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">subtractsBorderForOverflowNotVisible</span> <span class="o">=</span> <span class="p">(</span><span class="nx">checkDiv</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">===</span> <span class="o">-</span><span class="mi">5</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">doesNotIncludeMarginInBodyOffset</span> <span class="o">=</span> <span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">!==</span> <span class="nx">bodyMarginTop</span><span class="p">);</span>

    <span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span> <span class="nx">container</span> <span class="p">);</span>
    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">noop</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">bodyOffset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">body</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="nx">body</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">,</span>
      <span class="nx">left</span> <span class="o">=</span> <span class="nx">body</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span>

    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">doesNotIncludeMarginInBodyOffset</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">top</span>  <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="s2">&quot;marginTop&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nx">left</span> <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="s2">&quot;marginLeft&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span> <span class="nx">top</span><span class="o">:</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="nx">left</span> <span class="p">};</span>
  <span class="p">},</span>

  <span class="nx">setOffset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">i</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">position</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>set position first, in-case top/left are set even on static elem</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;static&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">elem</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s2">&quot;relative&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">curElem</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">),</span>
      <span class="nx">curOffset</span> <span class="o">=</span> <span class="nx">curElem</span><span class="p">.</span><span class="nx">offset</span><span class="p">(),</span>
      <span class="nx">curCSSTop</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span> <span class="p">),</span>
      <span class="nx">curCSSLeft</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span> <span class="p">),</span>
      <span class="nx">calculatePosition</span> <span class="o">=</span> <span class="p">(</span><span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;absolute&quot;</span> <span class="o">||</span> <span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;fixed&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">curCSSTop</span><span class="p">,</span> <span class="nx">curCSSLeft</span><span class="p">])</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
      <span class="nx">props</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">curPosition</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">curTop</span><span class="p">,</span> <span class="nx">curLeft</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>need to be able to calculate position if either top or left is auto and position is either absolute or fixed</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">calculatePosition</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">curPosition</span> <span class="o">=</span> <span class="nx">curElem</span><span class="p">.</span><span class="nx">position</span><span class="p">();</span>
      <span class="nx">curTop</span> <span class="o">=</span> <span class="nx">curPosition</span><span class="p">.</span><span class="nx">top</span><span class="p">;</span>
      <span class="nx">curLeft</span> <span class="o">=</span> <span class="nx">curPosition</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">curTop</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">curCSSTop</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nx">curLeft</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">curCSSLeft</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">curOffset</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">top</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">props</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">curOffset</span><span class="p">.</span><span class="nx">top</span><span class="p">)</span> <span class="o">+</span> <span class="nx">curTop</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">left</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">props</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">curOffset</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="o">+</span> <span class="nx">curLeft</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="s2">&quot;using&quot;</span> <span class="k">in</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">using</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">props</span> <span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">curElem</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="nx">props</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>


<span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">position</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get <em>real</em> offsetParent</p></div></div><div class="code"><div class="wrapper">    <span class="nx">offsetParent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">(),</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get correct offsets</p></div></div><div class="code"><div class="wrapper">    <span class="nx">offset</span>       <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">(),</span>
    <span class="nx">parentOffset</span> <span class="o">=</span> <span class="nx">rroot</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">)</span> <span class="o">?</span> <span class="p">{</span> <span class="nx">top</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span> <span class="p">}</span> <span class="o">:</span> <span class="nx">offsetParent</span><span class="p">.</span><span class="nx">offset</span><span class="p">();</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Subtract element margins
note: when an element has margin: auto the offsetLeft and marginLeft
are the same in Safari causing offset.left to incorrectly be 0</p></div></div><div class="code"><div class="wrapper">    <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span>  <span class="o">-=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;marginTop&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;marginLeft&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Add offsetParent borders</p></div></div><div class="code"><div class="wrapper">    <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">top</span>  <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;borderTopWidth&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">left</span> <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;borderLeftWidth&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Subtract the two offsets</p></div></div><div class="code"><div class="wrapper">    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">top</span><span class="o">:</span>  <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span>  <span class="o">-</span> <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span>
      <span class="nx">left</span><span class="o">:</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">left</span>
    <span class="p">};</span>
  <span class="p">},</span>

  <span class="nx">offsetParent</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">offsetParent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetParent</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
      <span class="k">while</span> <span class="p">(</span> <span class="nx">offsetParent</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">rroot</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;static&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">offsetParent</span> <span class="o">=</span> <span class="nx">offsetParent</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">offsetParent</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create scrollLeft and scrollTop methods</p></div></div><div class="code"><div class="wrapper"><span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="p">[</span><span class="s2">&quot;Left&quot;</span><span class="p">,</span> <span class="s2">&quot;Top&quot;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">name</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">method</span> <span class="o">=</span> <span class="s2">&quot;scroll&quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">;</span>

  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span> <span class="nx">method</span> <span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">val</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">win</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">val</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>

      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">elem</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">win</span> <span class="o">=</span> <span class="nx">getWindow</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Return the scroll offset</p></div></div><div class="code"><div class="wrapper">      <span class="k">return</span> <span class="nx">win</span> <span class="o">?</span> <span class="p">(</span><span class="s2">&quot;pageXOffset&quot;</span> <span class="k">in</span> <span class="nx">win</span><span class="p">)</span> <span class="o">?</span> <span class="nx">win</span><span class="p">[</span> <span class="nx">i</span> <span class="o">?</span> <span class="s2">&quot;pageYOffset&quot;</span> <span class="o">:</span> <span class="s2">&quot;pageXOffset&quot;</span> <span class="p">]</span> <span class="o">:</span>
        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">boxModel</span> <span class="o">&amp;&amp;</span> <span class="nx">win</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span> <span class="nx">method</span> <span class="p">]</span> <span class="o">||</span>
          <span class="nx">win</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">[</span> <span class="nx">method</span> <span class="p">]</span> <span class="o">:</span>
        <span class="nx">elem</span><span class="p">[</span> <span class="nx">method</span> <span class="p">];</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Set the scroll offset</p></div></div><div class="code"><div class="wrapper">    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">win</span> <span class="o">=</span> <span class="nx">getWindow</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nx">win</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">win</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span>
          <span class="o">!</span><span class="nx">i</span> <span class="o">?</span> <span class="nx">val</span> <span class="o">:</span> <span class="nx">jQuery</span><span class="p">(</span> <span class="nx">win</span> <span class="p">).</span><span class="nx">scrollLeft</span><span class="p">(),</span>
           <span class="nx">i</span> <span class="o">?</span> <span class="nx">val</span> <span class="o">:</span> <span class="nx">jQuery</span><span class="p">(</span> <span class="nx">win</span> <span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span>
        <span class="p">);</span>

      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">[</span> <span class="nx">method</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">};</span>
<span class="p">});</span>

<span class="kd">function</span> <span class="nx">getWindow</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">)</span> <span class="o">?</span>
    <span class="nx">elem</span> <span class="o">:</span>
    <span class="nx">elem</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">9</span> <span class="o">?</span>
      <span class="nx">elem</span><span class="p">.</span><span class="nx">defaultView</span> <span class="o">||</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">parentWindow</span> <span class="o">:</span>
      <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span></div></div></div></div></body></html>