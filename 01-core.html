<!DOCTYPE html><html lang="en"><head><title>01-core</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="01-core"><meta name="groc-project-path" content="jquery-1.6.2/01-core.js"><meta name="groc-github-url" content="https://github.com/nevir/jquery-annotated-source"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/nevir/jquery-annotated-source/blob/master/jquery-1.6.2/01-core.js">jquery-1.6.2/01-core.js</a></div></div><div id="document"><div class="segment"><div class="comments"><div class="wrapper"><p><strong>jQuery Annotated Source</strong>. You can view the source and contribute on <a href="https://github.com/robflaherty/jquery-annotated-source">Github</a>.</p></div></div><div class="code"><div class="wrapper"><span class="c1">//</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p><a href="/jquery-annotated-source/">Home</a> | <a href="02-deferred.html">Next Chapter</a></p></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><pre><code>jQuery JavaScript Library v1.6.2
http://jquery.com
Copyright 2011, John Resig
Dual licensed under the MIT or GPL Version 2 licenses.
http://jquery.org/license
Includes Sizzle.js
http://sizzlejs.com
Copyright 2011, The Dojo Foundation
Released under the MIT, BSD, and GPL Licenses.
Date: Thu Jun 30 14:16:56 2011 -0400
</code></pre></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h2 id="chapter-1-core">Chapter 1: Core</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nb">window</span><span class="p">,</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Use the correct document accordingly with window argument (sandbox)</p></div></div><div class="code"><div class="wrapper"><span class="kd">var</span> <span class="nb">document</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
  <span class="nx">navigator</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">navigator</span><span class="p">,</span>
  <span class="nx">location</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">;</span>

<span class="c1">//Hello, jQuery</span>
<span class="kd">var</span> <span class="nx">jQuery</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Define a local copy of jQuery.
The jQuery object is actually just the init constructor 'enhanced'</p></div></div><div class="code"><div class="wrapper">  <span class="kd">var</span> <span class="nx">jQuery</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">rootjQuery</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Map over jQuery in case of overwrite</p></div></div><div class="code"><div class="wrapper">  <span class="nx">_jQuery</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">jQuery</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Map over the $ in case of overwrite</p></div></div><div class="code"><div class="wrapper">  <span class="nx">_$</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">$</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A central reference to the root jQuery(document)</p></div></div><div class="code"><div class="wrapper">  <span class="nx">rootjQuery</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A simple way to check for HTML strings or ID strings
(both of which we optimize for)</p></div></div><div class="code"><div class="wrapper">  <span class="nx">quickExpr</span> <span class="o">=</span> <span class="sr">/^(?:[^&lt;]*(&lt;[\w\W]+&gt;)[^&gt;]*$|#([\w\-]*)$)/</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Check if a string has a non-whitespace character in it</p></div></div><div class="code"><div class="wrapper">  <span class="nx">rnotwhite</span> <span class="o">=</span> <span class="sr">/\S/</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Used for trimming whitespace</p></div></div><div class="code"><div class="wrapper">  <span class="nx">trimLeft</span> <span class="o">=</span> <span class="sr">/^\s+/</span><span class="p">,</span>
  <span class="nx">trimRight</span> <span class="o">=</span> <span class="sr">/\s+$/</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Check for digits</p></div></div><div class="code"><div class="wrapper">  <span class="nx">rdigit</span> <span class="o">=</span> <span class="sr">/\d/</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Match a standalone tag</p></div></div><div class="code"><div class="wrapper">  <span class="nx">rsingleTag</span> <span class="o">=</span> <span class="sr">/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;)?$/</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>JSON RegExp</p></div></div><div class="code"><div class="wrapper">  <span class="nx">rvalidchars</span> <span class="o">=</span> <span class="sr">/^[\],:{}\s]*$/</span><span class="p">,</span>
  <span class="nx">rvalidescape</span> <span class="o">=</span> <span class="sr">/\\(?:[&quot;\\\/bfnrt]|u[0-9a-fA-F]{4})/g</span><span class="p">,</span>
  <span class="nx">rvalidtokens</span> <span class="o">=</span> <span class="sr">/&quot;[^&quot;\\\n\r]*&quot;|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span><span class="p">,</span>
  <span class="nx">rvalidbraces</span> <span class="o">=</span> <span class="sr">/(?:^|:|,)(?:\s*\[)+/g</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Useragent RegExp</p></div></div><div class="code"><div class="wrapper">  <span class="nx">rwebkit</span> <span class="o">=</span> <span class="sr">/(webkit)[ \/]([\w.]+)/</span><span class="p">,</span>
  <span class="nx">ropera</span> <span class="o">=</span> <span class="sr">/(opera)(?:.*version)?[ \/]([\w.]+)/</span><span class="p">,</span>
  <span class="nx">rmsie</span> <span class="o">=</span> <span class="sr">/(msie) ([\w.]+)/</span><span class="p">,</span>
  <span class="nx">rmozilla</span> <span class="o">=</span> <span class="sr">/(mozilla)(?:.*? rv:([\w.]+))?/</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Matches dashed string for camelizing</p></div></div><div class="code"><div class="wrapper">  <span class="nx">rdashAlpha</span> <span class="o">=</span> <span class="sr">/-([a-z])/ig</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Used by jQuery.camelCase as callback to replace()</p></div></div><div class="code"><div class="wrapper">  <span class="nx">fcamelCase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">all</span><span class="p">,</span> <span class="nx">letter</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">letter</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Keep a UserAgent string for use with jQuery.browser</p></div></div><div class="code"><div class="wrapper">  <span class="nx">userAgent</span> <span class="o">=</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>For matching the engine and version of the browser</p></div></div><div class="code"><div class="wrapper">  <span class="nx">browserMatch</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The deferred used on DOM ready</p></div></div><div class="code"><div class="wrapper">  <span class="nx">readyList</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The ready event handler</p></div></div><div class="code"><div class="wrapper">  <span class="nx">DOMContentLoaded</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Save a reference to some core methods</p></div></div><div class="code"><div class="wrapper">  <span class="nx">toString</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">,</span>
  <span class="nx">hasOwn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">,</span>
  <span class="nx">push</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span><span class="p">,</span>
  <span class="nx">slice</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span>
  <span class="nx">trim</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span><span class="p">,</span>
  <span class="nx">indexOf</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>[[Class]] -> type pairs</p></div></div><div class="code"><div class="wrapper">  <span class="nx">class2type</span> <span class="o">=</span> <span class="p">{};</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h3 id="jquery-prototype">jQuery prototype</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  
  <span class="nx">constructor</span><span class="o">:</span> <span class="nx">jQuery</span><span class="p">,</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Main jQuery function</p></div></div><div class="code"><div class="wrapper">  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">rootjQuery</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">ret</span><span class="p">,</span> <span class="nx">doc</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle $(""), $(null), or $(undefined)</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">selector</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle $(DOMElement)</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">nodeType</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The body element only exists once, optimize finding it</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">selector</span> <span class="o">===</span> <span class="s2">&quot;body&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">context</span> <span class="o">&amp;&amp;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="nb">document</span><span class="p">;</span>
      <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle HTML strings</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">selector</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Are we dealing with HTML string or an ID?</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="p">(</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;&gt;&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Assume that strings that start and end with &lt;> are HTML and skip the regex check</p></div></div><div class="code"><div class="wrapper">        <span class="nx">match</span> <span class="o">=</span> <span class="p">[</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="kc">null</span> <span class="p">];</span>

      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">match</span> <span class="o">=</span> <span class="nx">quickExpr</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
      <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Verify a match, and that no context was specified for #id</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="p">(</span> <span class="nx">match</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="o">!</span><span class="nx">context</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>HANDLE: $(html) -> $(array)</p></div></div><div class="code"><div class="wrapper">        <span class="k">if</span> <span class="p">(</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span> <span class="k">instanceof</span> <span class="nx">jQuery</span> <span class="o">?</span> <span class="nx">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="nx">context</span><span class="p">;</span>
          <span class="nx">doc</span> <span class="o">=</span> <span class="p">(</span><span class="nx">context</span> <span class="o">?</span> <span class="nx">context</span><span class="p">.</span><span class="nx">ownerDocument</span> <span class="o">||</span> <span class="nx">context</span> <span class="o">:</span> <span class="nb">document</span><span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>If a single string is passed in and it's a single tag
just do a createElement and skip the rest</p></div></div><div class="code"><div class="wrapper">          <span class="nx">ret</span> <span class="o">=</span> <span class="nx">rsingleTag</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>

          <span class="k">if</span> <span class="p">(</span> <span class="nx">ret</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
              <span class="nx">selector</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="nx">ret</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">];</span>
              <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">attr</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>

            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
              <span class="nx">selector</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="nx">ret</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">];</span>
            <span class="p">}</span>

          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">buildFragment</span><span class="p">(</span> <span class="p">[</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">],</span> <span class="p">[</span> <span class="nx">doc</span> <span class="p">]</span> <span class="p">);</span>
            <span class="nx">selector</span> <span class="o">=</span> <span class="p">(</span><span class="nx">ret</span><span class="p">.</span><span class="nx">cacheable</span> <span class="o">?</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">ret</span><span class="p">.</span><span class="nx">fragment</span><span class="p">)</span> <span class="o">:</span> <span class="nx">ret</span><span class="p">.</span><span class="nx">fragment</span><span class="p">).</span><span class="nx">childNodes</span><span class="p">;</span>
          <span class="p">}</span>

          <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">selector</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>HANDLE: $("#id")</p></div></div><div class="code"><div class="wrapper">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">elem</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Check parentNode to catch when Blackberry 4.6 returns
nodes that are no longer in the document #6963</p></div></div><div class="code"><div class="wrapper">          <span class="k">if</span> <span class="p">(</span> <span class="nx">elem</span> <span class="o">&amp;&amp;</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">parentNode</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle the case where IE and Opera return items
by name instead of ID</p></div></div><div class="code"><div class="wrapper">            <span class="k">if</span> <span class="p">(</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">id</span> <span class="o">!==</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">rootjQuery</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
            <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Otherwise, we inject the element directly into the jQuery object</p></div></div><div class="code"><div class="wrapper">            <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">;</span>
          <span class="p">}</span>

          <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="nb">document</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">;</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>HANDLE: $(expr, $(...))</p></div></div><div class="code"><div class="wrapper">      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">context</span> <span class="o">||</span> <span class="nx">context</span><span class="p">.</span><span class="nx">jquery</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">context</span> <span class="o">||</span> <span class="nx">rootjQuery</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>HANDLE: $(expr, context)
(which is just equivalent to: $(context).find(expr)</p></div></div><div class="code"><div class="wrapper">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span> <span class="nx">context</span> <span class="p">).</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
      <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>HANDLE: $(function)
Shortcut for document ready</p></div></div><div class="code"><div class="wrapper">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">rootjQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">selector</span><span class="p">.</span><span class="nx">selector</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">selector</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">context</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="k">this</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Start with an empty selector</p></div></div><div class="code"><div class="wrapper">  <span class="nx">selector</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The current version of jQuery being used</p></div></div><div class="code"><div class="wrapper">  <span class="nx">jquery</span><span class="o">:</span> <span class="s2">&quot;1.6.2&quot;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The default length of a jQuery object is 0</p></div></div><div class="code"><div class="wrapper">  <span class="nx">length</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The number of elements contained in the matched element set</p></div></div><div class="code"><div class="wrapper">  <span class="nx">size</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Retrieve all the DOM elements contained in the jQuery set, as an array</p></div></div><div class="code"><div class="wrapper">  <span class="nx">toArray</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get the Nth element in the matched element set OR
Get the whole matched element set as a clean array</p></div></div><div class="code"><div class="wrapper">  <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">num</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">num</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Return a 'clean' array</p></div></div><div class="code"><div class="wrapper">      <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span> <span class="o">:</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Return just the object</p></div></div><div class="code"><div class="wrapper">      <span class="p">(</span> <span class="nx">num</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="k">this</span><span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">num</span> <span class="p">]</span> <span class="o">:</span> <span class="k">this</span><span class="p">[</span> <span class="nx">num</span> <span class="p">]</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Take an array of elements and push it onto the stack
(returning the new matched element set)</p></div></div><div class="code"><div class="wrapper">  <span class="nx">pushStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elems</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">selector</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Build a new jQuery matched element set</p></div></div><div class="code"><div class="wrapper">    <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span> <span class="nx">elems</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="nx">ret</span><span class="p">,</span> <span class="nx">elems</span> <span class="p">);</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="nx">ret</span><span class="p">,</span> <span class="nx">elems</span> <span class="p">);</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Add the old object onto the stack (as a reference)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">ret</span><span class="p">.</span><span class="nx">prevObject</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="nx">ret</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">name</span> <span class="o">===</span> <span class="s2">&quot;find&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">ret</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">?</span> <span class="s2">&quot; &quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">selector</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">name</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">ret</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nx">selector</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Return the newly-formed element set</p></div></div><div class="code"><div class="wrapper">    <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Execute a callback for every element in the matched set.
(You can seed the arguments with an array of args, but this is
only used internally.)</p></div></div><div class="code"><div class="wrapper">  <span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">args</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">args</span> <span class="p">);</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Specify a function to execute when the DOM is fully loaded.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">ready</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">fn</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Attach the listeners</p></div></div><div class="code"><div class="wrapper">    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">bindReady</span><span class="p">();</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Add the callback</p></div></div><div class="code"><div class="wrapper">    <span class="nx">readyList</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span> <span class="nx">fn</span> <span class="p">);</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Reduce the set of matched elements to the one at the specified index</p></div></div><div class="code"><div class="wrapper">  <span class="nx">eq</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">i</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">i</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span> <span class="nx">i</span> <span class="p">)</span> <span class="o">:</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span> <span class="nx">i</span><span class="p">,</span> <span class="o">+</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">);</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Reduce the set of matched elements to the first in the set</p></div></div><div class="code"><div class="wrapper">  <span class="nx">first</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span> <span class="mi">0</span> <span class="p">);</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Reduce the set of matched elements to the final one in the set</p></div></div><div class="code"><div class="wrapper">  <span class="nx">last</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="p">);</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Reduce the set of matched elements to a subset specified by a range of indices</p></div></div><div class="code"><div class="wrapper">  <span class="nx">slice</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span> <span class="p">),</span>
      <span class="s2">&quot;slice&quot;</span><span class="p">,</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Pass each element in the current matched set through a function, producing a new jQuery object containing the return values</p></div></div><div class="code"><div class="wrapper">  <span class="nx">map</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">callback</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">i</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">elem</span> <span class="p">);</span>
    <span class="p">}));</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>End the most recent filtering operation in the current chain and return the set of matched elements to its previous state</p></div></div><div class="code"><div class="wrapper">  <span class="nx">end</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">prevObject</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>For internal use only.
Behaves like an Array's method, not like a jQuery method.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">push</span><span class="o">:</span> <span class="nx">push</span><span class="p">,</span>
  <span class="nx">sort</span><span class="o">:</span> <span class="p">[].</span><span class="nx">sort</span><span class="p">,</span>
  <span class="nx">splice</span><span class="o">:</span> <span class="p">[].</span><span class="nx">splice</span>
<span class="p">};</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Give the init function the jQuery prototype for later instantiation</p></div></div><div class="code"><div class="wrapper"><span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h3 id="utilities">Utilities</h3></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Merge the contents of two or more objects together into the first object</p></div></div><div class="code"><div class="wrapper"><span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">copy</span><span class="p">,</span> <span class="nx">copyIsArray</span><span class="p">,</span> <span class="nx">clone</span><span class="p">,</span>
    <span class="nx">target</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="p">{},</span>
    <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">length</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
    <span class="nx">deep</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle a deep copy situation</p></div></div><div class="code"><div class="wrapper">  <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">target</span> <span class="o">===</span> <span class="s2">&quot;boolean&quot;</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">deep</span> <span class="o">=</span> <span class="nx">target</span><span class="p">;</span>
    <span class="nx">target</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="p">{};</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>skip the boolean and the target</p></div></div><div class="code"><div class="wrapper">    <span class="nx">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle case when target is a string or something (possible in deep copy)</p></div></div><div class="code"><div class="wrapper">  <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">target</span> <span class="o">!==</span> <span class="s2">&quot;object&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">target</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>extend jQuery itself if only one argument is passed</p></div></div><div class="code"><div class="wrapper">  <span class="k">if</span> <span class="p">(</span> <span class="nx">length</span> <span class="o">===</span> <span class="nx">i</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">target</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="o">--</span><span class="nx">i</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Only deal with non-null/undefined values</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span> <span class="nx">i</span> <span class="p">])</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Extend the base object</p></div></div><div class="code"><div class="wrapper">      <span class="k">for</span> <span class="p">(</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">src</span> <span class="o">=</span> <span class="nx">target</span><span class="p">[</span> <span class="nx">name</span> <span class="p">];</span>
        <span class="nx">copy</span> <span class="o">=</span> <span class="nx">options</span><span class="p">[</span> <span class="nx">name</span> <span class="p">];</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prevent never-ending loop</p></div></div><div class="code"><div class="wrapper">        <span class="k">if</span> <span class="p">(</span> <span class="nx">target</span> <span class="o">===</span> <span class="nx">copy</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Recurse if we're merging plain objects or arrays</p></div></div><div class="code"><div class="wrapper">        <span class="k">if</span> <span class="p">(</span> <span class="nx">deep</span> <span class="o">&amp;&amp;</span> <span class="nx">copy</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">copy</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">copyIsArray</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">copy</span><span class="p">))</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nx">copyIsArray</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">copyIsArray</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">clone</span> <span class="o">=</span> <span class="nx">src</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="o">?</span> <span class="nx">src</span> <span class="o">:</span> <span class="p">[];</span>

          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">clone</span> <span class="o">=</span> <span class="nx">src</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="o">?</span> <span class="nx">src</span> <span class="o">:</span> <span class="p">{};</span>
          <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Never move original objects, clone them</p></div></div><div class="code"><div class="wrapper">          <span class="nx">target</span><span class="p">[</span> <span class="nx">name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">deep</span><span class="p">,</span> <span class="nx">clone</span><span class="p">,</span> <span class="nx">copy</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Don't bring in undefined values</p></div></div><div class="code"><div class="wrapper">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">copy</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">target</span><span class="p">[</span> <span class="nx">name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">copy</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Return the modified object</p></div></div><div class="code"><div class="wrapper">  <span class="k">return</span> <span class="nx">target</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="c1">//Relinquish jQuery&#39;s control of the $ variable  </span>
  <span class="nx">noConflict</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">deep</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">$</span> <span class="o">===</span> <span class="nx">jQuery</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">_$</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">deep</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">jQuery</span> <span class="o">===</span> <span class="nx">jQuery</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">jQuery</span> <span class="o">=</span> <span class="nx">_jQuery</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">jQuery</span><span class="p">;</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Is the DOM ready to be used? Set to true once it occurs.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">isReady</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A counter to track how many items to wait for before
the ready event fires. See #6781</p></div></div><div class="code"><div class="wrapper">  <span class="nx">readyWait</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Hold (or release) the ready event</p></div></div><div class="code"><div class="wrapper">  <span class="nx">holdReady</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">hold</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">hold</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">readyWait</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span> <span class="kc">true</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle when the DOM is ready</p></div></div><div class="code"><div class="wrapper">  <span class="nx">ready</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">wait</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Either a released hold or an DOMready/load event and not yet ready</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nx">wait</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span> <span class="o">!--</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">readyWait</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">wait</span> <span class="o">!==</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isReady</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">setTimeout</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
      <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Remember that the DOM is ready</p></div></div><div class="code"><div class="wrapper">      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isReady</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>If a normal DOM Ready event fired, decrement, and wait if need be</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="p">(</span> <span class="nx">wait</span> <span class="o">!==</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span> <span class="o">--</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">readyWait</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>If there are functions bound, to execute</p></div></div><div class="code"><div class="wrapper">      <span class="nx">readyList</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span> <span class="nb">document</span><span class="p">,</span> <span class="p">[</span> <span class="nx">jQuery</span> <span class="p">]</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Trigger any bound ready events</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">trigger</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">jQuery</span><span class="p">(</span> <span class="nb">document</span> <span class="p">).</span><span class="nx">trigger</span><span class="p">(</span> <span class="s2">&quot;ready&quot;</span> <span class="p">).</span><span class="nx">unbind</span><span class="p">(</span> <span class="s2">&quot;ready&quot;</span> <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">bindReady</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">readyList</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">readyList</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">_Deferred</span><span class="p">();</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Catch cases where $(document).ready() is called after the
browser event has already occurred.</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s2">&quot;complete&quot;</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Handle it asynchronously to allow scripts the opportunity to delay ready</p></div></div><div class="code"><div class="wrapper">      <span class="k">return</span> <span class="nx">setTimeout</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Mozilla, Opera and webkit nightlies currently support this event</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Use the handy event callback</p></div></div><div class="code"><div class="wrapper">      <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span> <span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span> <span class="nx">DOMContentLoaded</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A fallback to window.onload, that will always work</p></div></div><div class="code"><div class="wrapper">      <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span> <span class="s2">&quot;load&quot;</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>If IE event model is used</p></div></div><div class="code"><div class="wrapper">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">attachEvent</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>ensure firing before onload,
maybe late but safe also for iframes</p></div></div><div class="code"><div class="wrapper">      <span class="nb">document</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span> <span class="s2">&quot;onreadystatechange&quot;</span><span class="p">,</span> <span class="nx">DOMContentLoaded</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A fallback to window.onload, that will always work</p></div></div><div class="code"><div class="wrapper">      <span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span> <span class="s2">&quot;onload&quot;</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>If IE and not a frame
continually check to see if the document is ready</p></div></div><div class="code"><div class="wrapper">      <span class="kd">var</span> <span class="nx">toplevel</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="nx">toplevel</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">frameElement</span> <span class="o">==</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">doScroll</span> <span class="o">&amp;&amp;</span> <span class="nx">toplevel</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">doScrollCheck</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>See test/unit/core.js for details concerning isFunction.
Since version 1.3, DOM methods and functions like alert
aren't supported. They return false on IE (#2968).</p></div></div><div class="code"><div class="wrapper">  <span class="nx">isFunction</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">;</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Determine whether the argument is an array</p></div></div><div class="code"><div class="wrapper">  <span class="nx">isArray</span><span class="o">:</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span> <span class="o">||</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;array&quot;</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A crude way of determining if an object is a window</p></div></div><div class="code"><div class="wrapper">  <span class="nx">isWindow</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">obj</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;setInterval&quot;</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nb">isNaN</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="nx">rdigit</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">);</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Determine the internal JavaScript [[Class]] of an object</p></div></div><div class="code"><div class="wrapper">  <span class="nx">type</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
      <span class="nb">String</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="o">:</span>
      <span class="nx">class2type</span><span class="p">[</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;object&quot;</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Check to see if an object is a plain object (created using "{}" or "new Object")</p></div></div><div class="code"><div class="wrapper">  <span class="nx">isPlainObject</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Must be an Object.
Because of IE, we also have to check the presence of the constructor property.
Make sure that DOM nodes and window objects don't pass through, as well</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">obj</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">!==</span> <span class="s2">&quot;object&quot;</span> <span class="o">||</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Not own constructor property must be Object</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">&amp;&amp;</span>
      <span class="o">!</span><span class="nx">hasOwn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s2">&quot;constructor&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="o">!</span><span class="nx">hasOwn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;isPrototypeOf&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Own properties are enumerated firstly, so to speed up,
if last one is own, then all properties are own.</p></div></div><div class="code"><div class="wrapper">    <span class="kd">var</span> <span class="nx">key</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{}</span>

    <span class="k">return</span> <span class="nx">key</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">hasOwn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Check to see if an object is empty (contains no properties).</p></div></div><div class="code"><div class="wrapper">  <span class="nx">isEmptyObject</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">obj</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">msg</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="nx">msg</span><span class="p">;</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Takes a well-formed JSON string and returns the resulting JavaScript object.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">parseJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">data</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">data</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span> <span class="o">||</span> <span class="o">!</span><span class="nx">data</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Make sure leading/trailing whitespace is removed (IE can't handle it)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">data</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span> <span class="nx">data</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Attempt to parse using the native JSON parser first</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">JSON</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span> <span class="nx">data</span> <span class="p">);</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Make sure the incoming data is actual JSON
Logic borrowed from http://json.org/json2.js</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">rvalidchars</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="nx">data</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="nx">rvalidescape</span><span class="p">,</span> <span class="s2">&quot;@&quot;</span> <span class="p">)</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="nx">rvalidtokens</span><span class="p">,</span> <span class="s2">&quot;]&quot;</span> <span class="p">)</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="nx">rvalidbraces</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>

      <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Function</span><span class="p">(</span> <span class="s2">&quot;return &quot;</span> <span class="o">+</span> <span class="nx">data</span> <span class="p">))();</span>

    <span class="p">}</span>
    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span> <span class="s2">&quot;Invalid JSON: &quot;</span> <span class="o">+</span> <span class="nx">data</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Cross-browser xml parsing
(xml &amp; tmp used internally)</p></div></div><div class="code"><div class="wrapper">  <span class="nx">parseXML</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">data</span> <span class="p">,</span> <span class="nx">xml</span> <span class="p">,</span> <span class="nx">tmp</span> <span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">DOMParser</span> <span class="p">)</span> <span class="p">{</span> <span class="c1">// Standard</span>
      <span class="nx">tmp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DOMParser</span><span class="p">();</span>
      <span class="nx">xml</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">parseFromString</span><span class="p">(</span> <span class="nx">data</span> <span class="p">,</span> <span class="s2">&quot;text/xml&quot;</span> <span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// IE</span>
      <span class="nx">xml</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span> <span class="s2">&quot;Microsoft.XMLDOM&quot;</span> <span class="p">);</span>
      <span class="nx">xml</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="s2">&quot;false&quot;</span><span class="p">;</span>
      <span class="nx">xml</span><span class="p">.</span><span class="nx">loadXML</span><span class="p">(</span> <span class="nx">data</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">xml</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">tmp</span> <span class="o">||</span> <span class="o">!</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">||</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;parsererror&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span> <span class="s2">&quot;Invalid XML: &quot;</span> <span class="o">+</span> <span class="nx">data</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">xml</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>An empty function</p></div></div><div class="code"><div class="wrapper">  <span class="nx">noop</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Evaluates a script in a global context
Workarounds based on findings by Jim Driscoll
http://weblogs.java.net/blog/driscoll/archive/2009/09/08/eval-javascript-global-context</p></div></div><div class="code"><div class="wrapper">  <span class="nx">globalEval</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">data</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">rnotwhite</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="nx">data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>We use execScript on Internet Explorer
We use an anonymous function so that context is window
rather than jQuery in Firefox</p></div></div><div class="code"><div class="wrapper">      <span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">execScript</span> <span class="o">||</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">data</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">[</span> <span class="s2">&quot;eval&quot;</span> <span class="p">].</span><span class="nx">call</span><span class="p">(</span> <span class="nb">window</span><span class="p">,</span> <span class="nx">data</span> <span class="p">);</span>
      <span class="p">}</span> <span class="p">)(</span> <span class="nx">data</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Converts a dashed string to camelCased string;
Used by both the css and data modules</p></div></div><div class="code"><div class="wrapper">  <span class="nx">camelCase</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">string</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">string</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="nx">rdashAlpha</span><span class="p">,</span> <span class="nx">fcamelCase</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Returns the uppercase node name</p></div></div><div class="code"><div class="wrapper">  <span class="nx">nodeName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">name</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">&amp;&amp;</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>args is for internal usage only</p></div></div><div class="code"><div class="wrapper">  <span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">args</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">length</span> <span class="o">=</span> <span class="nx">object</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="nx">isObj</span> <span class="o">=</span> <span class="nx">length</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="nx">object</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">args</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">isObj</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">object</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="nx">object</span><span class="p">[</span> <span class="nx">name</span> <span class="p">],</span> <span class="nx">args</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="nx">object</span><span class="p">[</span> <span class="nx">i</span><span class="o">++</span> <span class="p">],</span> <span class="nx">args</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A special, fast, case for the most common use of each</p></div></div><div class="code"><div class="wrapper">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">isObj</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">object</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">object</span><span class="p">[</span> <span class="nx">name</span> <span class="p">],</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">object</span><span class="p">[</span> <span class="nx">name</span> <span class="p">]</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">object</span><span class="p">[</span> <span class="nx">i</span> <span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">object</span><span class="p">[</span> <span class="nx">i</span><span class="o">++</span> <span class="p">]</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">object</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Use native String.trim function wherever possible</p></div></div><div class="code"><div class="wrapper">  <span class="nx">trim</span><span class="o">:</span> <span class="nx">trim</span> <span class="o">?</span>
    <span class="kd">function</span><span class="p">(</span> <span class="nx">text</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
        <span class="s2">&quot;&quot;</span> <span class="o">:</span>
        <span class="nx">trim</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">text</span> <span class="p">);</span>
    <span class="p">}</span> <span class="o">:</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Otherwise use our own trimming functionality</p></div></div><div class="code"><div class="wrapper">    <span class="kd">function</span><span class="p">(</span> <span class="nx">text</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
        <span class="s2">&quot;&quot;</span> <span class="o">:</span>
        <span class="nx">text</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span> <span class="nx">trimLeft</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="p">).</span><span class="nx">replace</span><span class="p">(</span> <span class="nx">trimRight</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="p">);</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>results is for internal usage only</p></div></div><div class="code"><div class="wrapper">  <span class="nx">makeArray</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">array</span><span class="p">,</span> <span class="nx">results</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">results</span> <span class="o">||</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">array</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The window, strings (and functions) also have 'length'
The extra typeof function check is to prevent crashes
in Safari 2 (See: #3039)
Tweaked logic slightly to handle Blackberry 4.7 RegExp issues #6930</p></div></div><div class="code"><div class="wrapper">      <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span> <span class="nx">array</span> <span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;regexp&quot;</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span> <span class="nx">array</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">push</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">ret</span><span class="p">,</span> <span class="nx">array</span> <span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="nx">ret</span><span class="p">,</span> <span class="nx">array</span> <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Search for a specified value within an array and return its index (or -1 if not found).</p></div></div><div class="code"><div class="wrapper">  <span class="nx">inArray</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">array</span> <span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nx">indexOf</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">indexOf</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">array</span><span class="p">,</span> <span class="nx">elem</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">array</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="o">===</span> <span class="nx">elem</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Merge the contents of two arrays together into the first array.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">merge</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">first</span><span class="p">,</span> <span class="nx">second</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">first</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">second</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">second</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">first</span><span class="p">[</span> <span class="nx">i</span><span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">second</span><span class="p">[</span> <span class="nx">j</span> <span class="p">];</span>
      <span class="p">}</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span> <span class="nx">second</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">first</span><span class="p">[</span> <span class="nx">i</span><span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">second</span><span class="p">[</span> <span class="nx">j</span><span class="o">++</span> <span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">first</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">first</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Finds the elements of an array which satisfy a filter function. The original array is not affected</p></div></div><div class="code"><div class="wrapper">  <span class="nx">grep</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elems</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">inv</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">retVal</span><span class="p">;</span>
    <span class="nx">inv</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">inv</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Go through the array, only saving the items
that pass the validator function</p></div></div><div class="code"><div class="wrapper">    <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">elems</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">retVal</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">callback</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span> <span class="nx">i</span> <span class="p">],</span> <span class="nx">i</span> <span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">inv</span> <span class="o">!==</span> <span class="nx">retVal</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Translate all items in an array or object to new array of items.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">map</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elems</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">arg</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">length</span> <span class="o">=</span> <span class="nx">elems</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>jquery objects are treated as arrays</p></div></div><div class="code"><div class="wrapper">      <span class="nx">isArray</span> <span class="o">=</span> <span class="nx">elems</span> <span class="k">instanceof</span> <span class="nx">jQuery</span> <span class="o">||</span> <span class="nx">length</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">length</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">elems</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">elems</span><span class="p">[</span> <span class="nx">length</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span> <span class="nx">elems</span> <span class="p">)</span> <span class="p">)</span> <span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Go through the array, translating each of the items to their</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">isArray</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span> <span class="nx">i</span> <span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">arg</span> <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">ret</span><span class="p">[</span> <span class="nx">ret</span><span class="p">.</span><span class="nx">length</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Go through every key on the object,</p></div></div><div class="code"><div class="wrapper">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">elems</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span> <span class="nx">key</span> <span class="p">],</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">arg</span> <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">ret</span><span class="p">[</span> <span class="nx">ret</span><span class="p">.</span><span class="nx">length</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Flatten any nested arrays</p></div></div><div class="code"><div class="wrapper">    <span class="k">return</span> <span class="nx">ret</span><span class="p">.</span><span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="p">[],</span> <span class="nx">ret</span> <span class="p">);</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>A global GUID counter for objects</p></div></div><div class="code"><div class="wrapper">  <span class="nx">guid</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Bind a function to a context, optionally partially applying any
arguments.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">proxy</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">context</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">[</span> <span class="nx">context</span> <span class="p">];</span>
      <span class="nx">context</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
      <span class="nx">fn</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Quick check to determine if target is callable, in the spec
this throws a TypeError, but we will just return undefined.</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="nx">fn</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Simulated bind</p></div></div><div class="code"><div class="wrapper">    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span> <span class="p">),</span>
      <span class="nx">proxy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">arguments</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
      <span class="p">};</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Set the guid of unique handler to the same of original handler, so it can be removed</p></div></div><div class="code"><div class="wrapper">    <span class="nx">proxy</span><span class="p">.</span><span class="nx">guid</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">guid</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">guid</span> <span class="o">||</span> <span class="nx">proxy</span><span class="p">.</span><span class="nx">guid</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">guid</span><span class="o">++</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">proxy</span><span class="p">;</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Mutifunctional method to get and set values to a collection
The value/s can optionally be executed if it's a function</p></div></div><div class="code"><div class="wrapper">  <span class="nx">access</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elems</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">exec</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">pass</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">elems</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Setting many attributes</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">key</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span> <span class="nx">elems</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">key</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span> <span class="nx">exec</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">value</span> <span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">elems</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Setting one attribute</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nx">value</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Optionally, function values get executed if exec is true</p></div></div><div class="code"><div class="wrapper">      <span class="nx">exec</span> <span class="o">=</span> <span class="o">!</span><span class="nx">pass</span> <span class="o">&amp;&amp;</span> <span class="nx">exec</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>

      <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">fn</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">exec</span> <span class="o">?</span> <span class="nx">value</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">fn</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">)</span> <span class="o">:</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">pass</span> <span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">elems</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Getting an attribute</p></div></div><div class="code"><div class="wrapper">    <span class="k">return</span> <span class="nx">length</span> <span class="o">?</span> <span class="nx">fn</span><span class="p">(</span> <span class="nx">elems</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">key</span> <span class="p">)</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="p">},</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Return a number representing the current time</p></div></div><div class="code"><div class="wrapper">  <span class="nx">now</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">();</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Use of jQuery.browser is frowned upon.
More details: http://docs.jquery.com/Utilities/jQuery.browser</p></div></div><div class="code"><div class="wrapper">  <span class="nx">uaMatch</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">ua</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">ua</span> <span class="o">=</span> <span class="nx">ua</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">rwebkit</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">ua</span> <span class="p">)</span> <span class="o">||</span>
      <span class="nx">ropera</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">ua</span> <span class="p">)</span> <span class="o">||</span>
      <span class="nx">rmsie</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">ua</span> <span class="p">)</span> <span class="o">||</span>
      <span class="nx">ua</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;compatible&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">rmozilla</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">ua</span> <span class="p">)</span> <span class="o">||</span>
      <span class="p">[];</span>

    <span class="k">return</span> <span class="p">{</span> <span class="nx">browser</span><span class="o">:</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">version</span><span class="o">:</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;0&quot;</span> <span class="p">};</span>
  <span class="p">},</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Creates a new copy of jQuery whose properties and methods can be modified without affecting the original jQuery object.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">sub</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">jQuerySub</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">jQuerySub</span><span class="p">,</span> <span class="k">this</span> <span class="p">);</span>
    <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">superclass</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">fn</span> <span class="o">=</span> <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">this</span><span class="p">();</span>
    <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">jQuerySub</span><span class="p">;</span>
    <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">sub</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sub</span><span class="p">;</span>
    <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">init</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">context</span> <span class="o">&amp;&amp;</span> <span class="nx">context</span> <span class="k">instanceof</span> <span class="nx">jQuery</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">context</span> <span class="k">instanceof</span> <span class="nx">jQuerySub</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">context</span> <span class="o">=</span> <span class="nx">jQuerySub</span><span class="p">(</span> <span class="nx">context</span> <span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">rootjQuerySub</span> <span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">jQuerySub</span><span class="p">.</span><span class="nx">fn</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">rootjQuerySub</span> <span class="o">=</span> <span class="nx">jQuerySub</span><span class="p">(</span><span class="nb">document</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">jQuerySub</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">browser</span><span class="o">:</span> <span class="p">{}</span>
<span class="p">});</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Populate the class2type map</p></div></div><div class="code"><div class="wrapper"><span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s2">&quot;Boolean Number String Function Array Date RegExp Object&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">class2type</span><span class="p">[</span> <span class="s2">&quot;[object &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="p">});</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Pass user agent to internal <code>uaMatch()</code> function</p></div></div><div class="code"><div class="wrapper"><span class="nx">browserMatch</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">uaMatch</span><span class="p">(</span> <span class="nx">userAgent</span> <span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Set properties for jQuery.browser</p></div></div><div class="code"><div class="wrapper"><span class="k">if</span> <span class="p">(</span> <span class="nx">browserMatch</span><span class="p">.</span><span class="nx">browser</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">browser</span><span class="p">[</span> <span class="nx">browserMatch</span><span class="p">.</span><span class="nx">browser</span> <span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">browser</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="nx">browserMatch</span><span class="p">.</span><span class="nx">version</span><span class="p">;</span>
<span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Deprecated, use jQuery.browser.webkit instead</p></div></div><div class="code"><div class="wrapper"><span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">browser</span><span class="p">.</span><span class="nx">webkit</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">browser</span><span class="p">.</span><span class="nx">safari</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>IE doesn't match non-breaking spaces with \s</p></div></div><div class="code"><div class="wrapper"><span class="k">if</span> <span class="p">(</span> <span class="nx">rnotwhite</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="s2">&quot;\xA0&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">trimLeft</span> <span class="o">=</span> <span class="sr">/^[\s\xA0]+/</span><span class="p">;</span>
  <span class="nx">trimRight</span> <span class="o">=</span> <span class="sr">/[\s\xA0]+$/</span><span class="p">;</span>
<span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>All jQuery objects should point back to these</p></div></div><div class="code"><div class="wrapper"><span class="nx">rootjQuery</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="nb">document</span><span class="p">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Cleanup functions for the document ready method</p></div></div><div class="code"><div class="wrapper"><span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">DOMContentLoaded</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span> <span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span> <span class="nx">DOMContentLoaded</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>
    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">();</span>
  <span class="p">};</span>

<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">attachEvent</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">DOMContentLoaded</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s2">&quot;complete&quot;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">(</span> <span class="s2">&quot;onreadystatechange&quot;</span><span class="p">,</span> <span class="nx">DOMContentLoaded</span> <span class="p">);</span>
      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The DOM ready check for Internet Explorer</p></div></div><div class="code"><div class="wrapper"><span class="kd">function</span> <span class="nx">doScrollCheck</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isReady</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>If IE is used, use the trick by Diego Perini
http://javascript.nwbox.com/IEContentLoaded/</p></div></div><div class="code"><div class="wrapper">  <span class="k">try</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">doScroll</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span> <span class="nx">doScrollCheck</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>and execute any waiting functions</p></div></div><div class="code"><div class="wrapper">  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">return</span> <span class="nx">jQuery</span><span class="p">;</span>

<span class="p">})();</span></div></div></div></div></body></html>